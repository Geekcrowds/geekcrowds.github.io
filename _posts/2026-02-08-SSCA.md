---
title: "SSCA Protocol Explorer"
date: 2026-02-08 12:00:00 +1300
categories: [Tools]
tags: [sip]
---

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSCA® Advanced Protocol Explorer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
        }

        /* Chart Container Styling - Mandatory Requirements */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(226, 232, 240, 0.8);
        }
    </style>
    <!-- Chosen Palette: Slate & Indigo - Professional, trustworthy, high contrast for text -->
</head>
<body class="text-slate-800 antialiased h-screen flex overflow-hidden">

    <!-- Application Structure Plan:
         1. Sidebar Navigation: persistent access to Dashboard, Knowledge Base, and Analysis.
         2. Dashboard: High-level visualization of the report content (Topic breakdown, complexity).
         3. Knowledge Base: The core interactive list of Source Report data points (cards), filterable and searchable.
         4. Synthesis: A text-heavy section summarizing key themes (Security, NAT, Routing).
         Why: This structure allows users to jump between the "Big Picture" (Dashboard) and "Deep Details" (Knowledge Base) efficiently.
    -->

    <!-- Sidebar -->
    <aside class="w-64 bg-slate-900 text-white flex-col hidden md:flex shadow-xl z-20">
        <div class="p-6 border-b border-slate-700">
            <h1 class="text-xl font-bold tracking-tight"><i class="fas fa-network-wired mr-2 text-indigo-400"></i>SSCA® Explorer</h1>
            <p class="text-xs text-slate-400 mt-1">Advanced Certification Prep</p>
        </div>
        <nav class="flex-1 p-4 space-y-2">
            <button onclick="showSection('dashboard')" class="nav-btn w-full text-left px-4 py-3 rounded-lg hover:bg-slate-800 transition-colors flex items-center bg-slate-800 text-indigo-400 font-medium" id="btn-dashboard">
                <i class="fas fa-chart-pie w-6"></i> Dashboard
            </button>
            <button onclick="showSection('knowledge')" class="nav-btn w-full text-left px-4 py-3 rounded-lg hover:bg-slate-800 transition-colors flex items-center text-slate-300" id="btn-knowledge">
                <i class="fas fa-book-open w-6"></i> Knowledge Base
            </button>
            <button onclick="showSection('synthesis')" class="nav-btn w-full text-left px-4 py-3 rounded-lg hover:bg-slate-800 transition-colors flex items-center text-slate-300" id="btn-synthesis">
                <i class="fas fa-layer-group w-6"></i> Key Concepts
            </button>
        </nav>
        <div class="p-4 border-t border-slate-700">
            <div class="bg-slate-800 rounded-lg p-3">
                <p class="text-xs text-slate-400 mb-1">Knowledge Mastered</p>
                <div class="w-full bg-slate-700 rounded-full h-2">
                    <div id="mastery-bar" class="bg-indigo-500 h-2 rounded-full" style="width: 0%"></div>
                </div>
                <p class="text-right text-xs text-indigo-400 mt-1" id="mastery-text">0%</p>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 flex flex-col h-screen overflow-hidden bg-slate-50 relative">
        <!-- Mobile Header -->
        <header class="md:hidden bg-slate-900 text-white p-4 flex justify-between items-center shadow-md z-30">
            <h1 class="font-bold"><i class="fas fa-network-wired mr-2 text-indigo-400"></i>SSCA® Explorer</h1>
            <button onclick="document.querySelector('aside').classList.toggle('hidden'); document.querySelector('aside').classList.toggle('absolute'); document.querySelector('aside').classList.toggle('h-full');" class="text-slate-300">
                <i class="fas fa-bars text-xl"></i>
            </button>
        </header>

        <div id="content-area" class="flex-1 overflow-y-auto p-4 md:p-8">
            
            <!-- SECTION: DASHBOARD -->
            <section id="dashboard" class="space-y-6 max-w-7xl mx-auto animate-fade-in">
                <div class="mb-6">
                    <h2 class="text-3xl font-bold text-slate-800">Protocol Analysis Dashboard</h2>
                    <p class="text-slate-600 mt-2">Overview of SIP, SDP, and Security concepts extracted from the Source Report.</p>
                </div>

                <!-- Stats Cards -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                    <div class="glass-panel p-4 rounded-xl shadow-sm border-l-4 border-indigo-500">
                        <div class="text-slate-500 text-sm font-medium uppercase">Total Topics</div>
                        <div class="text-3xl font-bold text-slate-800 mt-1" id="stat-total">0</div>
                    </div>
                    <div class="glass-panel p-4 rounded-xl shadow-sm border-l-4 border-emerald-500">
                        <div class="text-slate-500 text-sm font-medium uppercase">Security Protocols</div>
                        <div class="text-3xl font-bold text-slate-800 mt-1" id="stat-security">0</div>
                    </div>
                    <div class="glass-panel p-4 rounded-xl shadow-sm border-l-4 border-blue-500">
                        <div class="text-slate-500 text-sm font-medium uppercase">Signaling Concepts</div>
                        <div class="text-3xl font-bold text-slate-800 mt-1" id="stat-signaling">0</div>
                    </div>
                    <div class="glass-panel p-4 rounded-xl shadow-sm border-l-4 border-amber-500">
                        <div class="text-slate-500 text-sm font-medium uppercase">Media/SDP</div>
                        <div class="text-3xl font-bold text-slate-800 mt-1" id="stat-media">0</div>
                    </div>
                </div>

                <!-- Visualization & Content Choices: 
                     1. Topic Distribution: Pie chart to show the balance of content (Security vs Signaling vs Media).
                     2. Difficulty Analysis: Bar chart visualizing the complexity of concepts based on keyword density in rationales.
                     Justification: Charts provide immediate context on the scope of the material before diving into text.
                -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="glass-panel p-6 rounded-xl shadow-sm">
                        <h3 class="text-lg font-semibold text-slate-800 mb-4">Topic Distribution</h3>
                        <div class="flex flex-col items-center justify-center">
                            <div class="chart-container">
                                <canvas id="topicChart"></canvas>
                            </div>
                            <p class="text-sm text-slate-500 mt-4 text-center">Breakdown of questions by primary technical domain.</p>
                        </div>
                    </div>
                    <div class="glass-panel p-6 rounded-xl shadow-sm">
                        <h3 class="text-lg font-semibold text-slate-800 mb-4">Concept Frequency</h3>
                        <div class="flex flex-col items-center justify-center">
                            <div class="chart-container">
                                <canvas id="conceptChart"></canvas>
                            </div>
                            <p class="text-sm text-slate-500 mt-4 text-center">Frequency of key technical terms across the source report.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SECTION: KNOWLEDGE BASE -->
            <section id="knowledge" class="hidden space-y-6 max-w-5xl mx-auto">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
                    <div>
                        <h2 class="text-3xl font-bold text-slate-800">Knowledge Base</h2>
                        <p class="text-slate-600 mt-2">Interactive exploration of specific SIP scenarios and RFC standards.</p>
                    </div>
                    <div class="flex gap-2">
                        <div class="relative">
                            <i class="fas fa-search absolute left-3 top-3 text-slate-400"></i>
                            <input type="text" id="searchInput" placeholder="Search topics..." class="pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                        <select id="categoryFilter" class="px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-white">
                            <option value="all">All Categories</option>
                            <option value="Security">Security & Identity</option>
                            <option value="Signaling">Signaling & Routing</option>
                            <option value="Media">Media & SDP</option>
                            <option value="Infrastructure">Infrastructure (NAT/SBC)</option>
                        </select>
                    </div>
                </div>

                <div id="cards-container" class="grid grid-cols-1 gap-6">
                    <!-- Cards injected via JS -->
                </div>
            </section>

            <!-- SECTION: SYNTHESIS -->
            <section id="synthesis" class="hidden space-y-8 max-w-4xl mx-auto">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold text-slate-800">Synthesized Insights</h2>
                    <p class="text-slate-600 mt-2">Consolidated analysis of the key technical themes derived from the source report.</p>
                </div>

                <div class="glass-panel p-8 rounded-xl shadow-sm border-t-4 border-indigo-500">
                    <h3 class="text-xl font-bold text-slate-800 mb-4 flex items-center">
                        <span class="bg-indigo-100 text-indigo-600 p-2 rounded-lg mr-3"><i class="fas fa-shield-alt"></i></span>
                        The Evolution of SIP Identity (STIR/SHAKEN)
                    </h3>
                    <div class="prose text-slate-600 max-w-none">
                        <p class="mb-4">
                            The source report highlights a critical shift in SIP security, moving beyond simple Digest Authentication (401/407) towards cryptographic identity assertion. The integration of the <strong>Identity</strong> header containing signed JSON Web Tokens (PASSporT) is paramount.
                        </p>
                        <ul class="list-disc pl-5 space-y-2 mb-4">
                            <li><strong>Attestation Levels:</strong> A clear distinction is made between Level A (Full), Level B (Partial - customer known, number unverified), and Level C (Gateway).</li>
                            <li><strong>Header Structure:</strong> The 'ppt' parameter (e.g., 'shaken') and 'x5u' (Certificate URL) are mandatory for verifying the signature chain.</li>
                            <li><strong>Legacy Support:</strong> While P-Asserted-Identity (PAI) remains standard for trusted domains, Remote-Party-ID is explicitly deprecated.</li>
                        </ul>
                    </div>
                </div>

                <div class="glass-panel p-8 rounded-xl shadow-sm border-t-4 border-emerald-500">
                    <h3 class="text-xl font-bold text-slate-800 mb-4 flex items-center">
                        <span class="bg-emerald-100 text-emerald-600 p-2 rounded-lg mr-3"><i class="fas fa-wave-square"></i></span>
                        Advanced Media Negotiation & NAT
                    </h3>
                    <div class="prose text-slate-600 max-w-none">
                        <p class="mb-4">
                            Media handling has evolved to support complex network topologies. The report emphasizes the "Delayed Offer" vs. "Early Offer" models and the critical role of the <strong>ACK</strong> message in finalizing media in delayed scenarios.
                        </p>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                            <div class="bg-slate-50 p-4 rounded-lg">
                                <h4 class="font-semibold text-slate-800 mb-2">SDP Attributes</h4>
                                <p class="text-sm">Usage of <code>a=sendonly</code> for hold states (replacing legacy c=0.0.0.0) and <code>a=rtcp-mux</code> to consolidate ports for NAT traversal.</p>
                            </div>
                            <div class="bg-slate-50 p-4 rounded-lg">
                                <h4 class="font-semibold text-slate-800 mb-2">Topology Hiding</h4>
                                <p class="text-sm">SBCs actively manipulate headers, stripping <code>Record-Route</code> and <code>Via</code> headers to protect internal network architecture from external visibility.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="glass-panel p-8 rounded-xl shadow-sm border-t-4 border-amber-500">
                    <h3 class="text-xl font-bold text-slate-800 mb-4 flex items-center">
                        <span class="bg-amber-100 text-amber-600 p-2 rounded-lg mr-3"><i class="fas fa-exclamation-triangle"></i></span>
                        Troubleshooting & Error Handling
                    </h3>
                    <div class="prose text-slate-600 max-w-none">
                        <p class="mb-4">
                            Effective troubleshooting requires precise knowledge of response codes and header behavior. Key scenarios identified include:
                        </p>
                        <ul class="list-disc pl-5 space-y-2">
                            <li><strong>491 Request Pending:</strong> Specifically indicates "Glare" (simultaneous re-INVITES), resolved by timer back-offs.</li>
                            <li><strong>422 Session Interval Too Small:</strong> Requires the UAC to respect the <code>Min-SE</code> header provided by the server.</li>
                            <li><strong>415 Unsupported Media Type:</strong> Indicates a mismatch in body format capabilities (often SDP issues).</li>
                            <li><strong>504 Gateway Timeout:</strong> Specific to gateway failures in receiving upstream responses (e.g., ICMP Unreachable).</li>
                        </ul>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <script>
        // Source Data derived from the provided Quiz JSON files in the prompt context.
        // Categories: Security, Signaling, Media, Infrastructure
        const sourceData = [
            // From ssca_quiz_export.json
            {
                id: 1,
                category: "Security",
                topic: "STIR/SHAKEN",
                question: "In STIR/SHAKEN, what information is missing in 'Attestation Level B' compared to Level A?",
                answer: "Verification of the customer's right to use the specific calling number.",
                rationale: "Level B indicates the provider knows the customer but cannot verify the specific Origination ID (TN) ownership. This is critical for tracing calls where the number might not belong to the trunk owner.",
                complexity: "High",
                tags: ["Identity", "Attestation"]
            },
            {
                id: 2,
                category: "Signaling",
                topic: "SIP Transactions",
                question: "What logic handles a 491 'Request Pending' during a re-INVITE?",
                answer: "The UAC must wait a random time between 2.1 and 4.0 seconds (if owner) before retrying.",
                rationale: "This resolves 'Glare' conditions where both endpoints try to update the session state simultaneously. RFC 3261 mandates specific back-off timers.",
                complexity: "High",
                tags: ["Timer", "Glare", "RFC 3261"]
            },
            {
                id: 3,
                category: "Signaling",
                topic: "Interworking",
                question: "Mapping SIP '404 Not Found' to ISDN Q.850 Cause Code.",
                answer: "Q.850 Cause 1 (Unallocated Number).",
                rationale: "A 404 indicates the URI does not exist in the domain, which maps directly to an unallocated number in legacy PSTN signaling.",
                complexity: "Medium",
                tags: ["Q.850", "Codes"]
            },
            {
                id: 4,
                category: "Media",
                topic: "SDP BUNDLE",
                question: "Why include 'a=mid' in an SDP BUNDLE group?",
                answer: "To allow the BUNDLE attribute to identify which media streams are being multiplexed.",
                rationale: "The BUNDLE line references media IDs (mids) to logically group multiple 'm=' lines onto a single transport address.",
                complexity: "High",
                tags: ["SDP", "Multiplexing"]
            },
            {
                id: 5,
                category: "Media",
                topic: "RTCP Feedback",
                question: "Purpose of 'a=rtcp-fb' with 'nack' parameter.",
                answer: "To allow the receiver to request retransmission of specific lost RTP packets.",
                rationale: "Generic NACK improves media quality over lossy links by signaling exactly which packets were dropped, rather than waiting for a full keyframe.",
                complexity: "Medium",
                tags: ["RTCP", "QoS"]
            },
            {
                id: 6,
                category: "Signaling",
                topic: "Event Notification",
                question: "Action upon receiving NOTIFY 'Subscription-State: terminated; reason=timeout'.",
                answer: "Attempt to re-subscribe if the resource still needs monitoring.",
                rationale: "The 'timeout' reason implies a natural expiration of the subscription duration, requiring a refresh from the subscriber.",
                complexity: "Medium",
                tags: ["NOTIFY", "SUBSCRIBE"]
            },
            {
                id: 7,
                category: "Security",
                topic: "Secure Media",
                question: "What does the 'S' in 'RTP/SAVP' signify in an SDP media line?",
                answer: "The media stream is using the Secure Real-time Transport Protocol (SRTP).",
                rationale: "SAVP stands for Secure Audio Video Profile. It mandates encryption and authentication for the media stream.",
                complexity: "Low",
                tags: ["SRTP", "SDP"]
            },
            {
                id: 8,
                category: "Infrastructure",
                topic: "SBC Functions",
                question: "Result of SBC 'Media Release' (Anti-Tromboning).",
                answer: "The RTP flows directly between endpoints, bypassing the SBC.",
                rationale: "Optimizes bandwidth by removing the SBC from the media path once signaling establishes that endpoints can reach each other directly.",
                complexity: "Medium",
                tags: ["SBC", "RTP"]
            },
            {
                id: 9,
                category: "Signaling",
                topic: "Call Transfer",
                question: "Purpose of 'Refer-Sub: false' in a REFER request.",
                answer: "To request that the recipient does not create an implicit subscription for NOTIFY updates.",
                rationale: "Reduces signaling overhead by suppressing the stream of NOTIFY messages that usually track the progress of a transfer.",
                complexity: "High",
                tags: ["REFER", "NOTIFY"]
            },
            {
                id: 10,
                category: "Signaling",
                topic: "Registration",
                question: "Role of the 'Path' header (RFC 3327).",
                answer: "Allows a proxy to inform the registrar of the route to be used to reach the UA.",
                rationale: "Essential for SBCs and proxies sitting between the UA and Registrar to ensure they stay in the path for inbound calls.",
                complexity: "High",
                tags: ["Headers", "Registration"]
            },
            // From ssca_advanced_prep_09 (Advanced Set 2)
            {
                id: 11,
                category: "Call Control",
                topic: "Session Timers",
                question: "Proxy behavior if UAC doesn't support required Session Timer.",
                answer: "Reject INVITE with 422 (Session Interval Too Small).",
                rationale: "Enforces network policy by forcing the client to increase the timer or implement the timer extension using the Min-SE header.",
                complexity: "Medium",
                tags: ["RFC 4028", "422"]
            },
            {
                id: 12,
                category: "Media",
                topic: "Hold Mechanics",
                question: "SDP attribute for 'Music on Hold' (sender side).",
                answer: "a=sendonly",
                rationale: "The holder sends 'sendonly' to indicate they will send media (music) but stop listening to the held party. The answerer responds with 'recvonly'.",
                complexity: "Medium",
                tags: ["SDP", "Hold"]
            },
            {
                id: 13,
                category: "Security",
                topic: "Identity Token",
                question: "Which Identity header parameter contains the cryptographic signature?",
                answer: "The JSON Web Signature (JWS) in the Identity header value.",
                rationale: "While 'alg' and 'ppt' are parameters, the header value itself is the signed token (header.payload.signature).",
                complexity: "High",
                tags: ["STIR/SHAKEN", "JWS"]
            },
            {
                id: 14,
                category: "Security",
                topic: "Authentication",
                question: "Difference between 401 and 407 response codes.",
                answer: "401 is from Registrar/UAS; 407 is from an Outbound Proxy/SBC.",
                rationale: "401 triggers WWW-Authenticate (End-to-End); 407 triggers Proxy-Authenticate (Hop-by-Hop).",
                complexity: "Low",
                tags: ["Codes", "Auth"]
            },
            {
                id: 15,
                category: "Media",
                topic: "Payload Types",
                question: "What does '96' represent in 'm=video ... 96'?",
                answer: "A dynamic payload type mapped to a specific codec.",
                rationale: "Static payloads are 0-34. Numbers 96+ are dynamic and must be defined by an 'a=rtpmap' line (e.g., H.264).",
                complexity: "Medium",
                tags: ["RTP", "Codec"]
            },
            {
                id: 16,
                category: "Call Control",
                topic: "Session Health",
                question: "Header used to prevent 'Ghost Calls'.",
                answer: "Session-Expires",
                rationale: "Used in conjunction with re-INVITEs to ensure the session is still active. If the timer expires without refresh, the call is torn down.",
                complexity: "Medium",
                tags: ["Timers", "RFC 4028"]
            },
            {
                id: 17,
                category: "Infrastructure",
                topic: "SBC Security",
                question: "Why strip 'Record-Route' headers at the SBC?",
                answer: "Topology Hiding.",
                rationale: "Prevents external parties from seeing the IP addresses and structure of the internal core network.",
                complexity: "Medium",
                tags: ["SBC", "Security"]
            },
            {
                id: 18,
                category: "Media",
                topic: "SDP Errors",
                question: "Implication of '415 Unsupported Media Type'.",
                answer: "The server does not understand the format of the message body (e.g., no SDP support).",
                rationale: "This is distinct from 488 (Not Acceptable Here), which means the SDP was understood but the codecs weren't compatible.",
                complexity: "Medium",
                tags: ["Codes", "SDP"]
            },
            {
                id: 19,
                category: "Call Control",
                topic: "Transfers",
                question: "Response to indicate REFER has been initiated.",
                answer: "202 Accepted",
                rationale: "Indicates the request is valid and processing has started, but the final outcome (transfer success/fail) is not yet known.",
                complexity: "Medium",
                tags: ["REFER", "Codes"]
            },
            {
                id: 20,
                category: "Media",
                topic: "RTCP Reports",
                question: "Function of Sender Reports (SR) and Receiver Reports (RR).",
                answer: "To provide Quality of Service (QoS) statistics.",
                rationale: "Includes metrics like jitter, packet loss, and round-trip delay to monitor call health.",
                complexity: "Low",
                tags: ["RTCP", "QoS"]
            }
        ];

        // State Management
        let learnedItems = JSON.parse(localStorage.getItem('ssca_learned')) || [];

        function init() {
            renderDashboard();
            renderKnowledgeBase();
            updateMasteryBar();
        }

        // Toggle Section Visibility
        window.showSection = function(sectionId) {
            document.querySelectorAll('section').forEach(el => el.classList.add('hidden'));
            document.getElementById(sectionId).classList.remove('hidden');
            
            // Update active nav state
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('bg-slate-800', 'text-indigo-400', 'font-medium');
                btn.classList.add('text-slate-300');
            });
            document.getElementById(`btn-${sectionId}`).classList.add('bg-slate-800', 'text-indigo-400', 'font-medium');
            document.getElementById(`btn-${sectionId}`).classList.remove('text-slate-300');
        };

        // Render Dashboard Charts
        function renderDashboard() {
            // Calculate Stats
            const total = sourceData.length;
            const catCounts = sourceData.reduce((acc, curr) => {
                acc[curr.category] = (acc[curr.category] || 0) + 1;
                return acc;
            }, {});

            document.getElementById('stat-total').innerText = total;
            document.getElementById('stat-security').innerText = catCounts['Security'] || 0;
            document.getElementById('stat-signaling').innerText = (catCounts['Signaling'] || 0) + (catCounts['Call Control'] || 0); // grouping for UI
            document.getElementById('stat-media').innerText = catCounts['Media'] || 0;

            // Chart 1: Topic Distribution (Pie)
            const ctx1 = document.getElementById('topicChart').getContext('2d');
            new Chart(ctx1, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(catCounts),
                    datasets: [{
                        data: Object.values(catCounts),
                        backgroundColor: ['#6366f1', '#10b981', '#f59e0b', '#3b82f6', '#8b5cf6'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'right' }
                    }
                }
            });

            // Chart 2: Keyword Frequency (Bar) - simplified analysis
            // Counts tags
            const tagCounts = {};
            sourceData.forEach(item => {
                item.tags.forEach(tag => {
                    tagCounts[tag] = (tagCounts[tag] || 0) + 1;
                });
            });
            // Get top 8 tags
            const sortedTags = Object.entries(tagCounts).sort((a,b) => b[1] - a[1]).slice(0, 8);

            const ctx2 = document.getElementById('conceptChart').getContext('2d');
            new Chart(ctx2, {
                type: 'bar',
                data: {
                    labels: sortedTags.map(t => t[0]),
                    datasets: [{
                        label: 'Frequency',
                        data: sortedTags.map(t => t[1]),
                        backgroundColor: '#6366f1',
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: true, ticks: { stepSize: 1 } }
                    }
                }
            });
        }

        // Render Knowledge Cards
        function renderKnowledgeBase() {
            const container = document.getElementById('cards-container');
            const filter = document.getElementById('categoryFilter').value;
            const search = document.getElementById('searchInput').value.toLowerCase();

            container.innerHTML = '';

            const filteredData = sourceData.filter(item => {
                const matchesCategory = filter === 'all' || item.category === filter;
                const matchesSearch = item.question.toLowerCase().includes(search) || 
                                      item.topic.toLowerCase().includes(search) || 
                                      item.rationale.toLowerCase().includes(search);
                return matchesCategory && matchesSearch;
            });

            filteredData.forEach(item => {
                const isLearned = learnedItems.includes(item.id);
                const card = document.createElement('div');
                card.className = `bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden transition-all duration-300 hover:shadow-md ${isLearned ? 'border-l-4 border-l-emerald-500' : 'border-l-4 border-l-indigo-500'}`;
                
                card.innerHTML = `
                    <div class="p-6 cursor-pointer" onclick="toggleDetails(${item.id})">
                        <div class="flex justify-between items-start mb-2">
                            <span class="text-xs font-bold uppercase tracking-wider ${getCategoryColor(item.category)} px-2 py-1 rounded">${item.category}</span>
                            <button onclick="event.stopPropagation(); toggleLearned(${item.id})" class="text-slate-300 hover:text-emerald-500 transition-colors ${isLearned ? 'text-emerald-500' : ''}" title="Mark as Learned">
                                <i class="fas fa-check-circle text-xl"></i>
                            </button>
                        </div>
                        <h4 class="text-lg font-semibold text-slate-800 mb-2 pr-6">${item.question}</h4>
                        <div class="flex items-center text-sm text-slate-500">
                            <i class="fas fa-tag mr-2 text-slate-400"></i> ${item.topic}
                            <span class="mx-2">•</span>
                            <span class="text-xs bg-slate-100 px-2 py-0.5 rounded text-slate-500">Complexity: ${item.complexity}</span>
                        </div>
                    </div>
                    <div id="details-${item.id}" class="hidden bg-slate-50 border-t border-slate-100 p-6 animate-fade-in">
                        <div class="mb-4">
                            <p class="text-sm text-slate-500 font-medium uppercase mb-1">Correct Answer</p>
                            <p class="text-indigo-700 font-semibold">${item.answer}</p>
                        </div>
                        <div>
                            <p class="text-sm text-slate-500 font-medium uppercase mb-1">Rationale</p>
                            <p class="text-slate-700 leading-relaxed">${item.rationale}</p>
                        </div>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // Helper: Category Colors
        function getCategoryColor(cat) {
            switch(cat) {
                case 'Security': return 'bg-rose-100 text-rose-600';
                case 'Signaling': return 'bg-blue-100 text-blue-600';
                case 'Media': return 'bg-amber-100 text-amber-600';
                case 'Infrastructure': return 'bg-purple-100 text-purple-600';
                case 'Call Control': return 'bg-emerald-100 text-emerald-600';
                default: return 'bg-slate-100 text-slate-600';
            }
        }

        // Interactions
        window.toggleDetails = function(id) {
            const el = document.getElementById(`details-${id}`);
            el.classList.toggle('hidden');
        };

        window.toggleLearned = function(id) {
            if (learnedItems.includes(id)) {
                learnedItems = learnedItems.filter(i => i !== id);
            } else {
                learnedItems.push(id);
            }
            localStorage.setItem('ssca_learned', JSON.stringify(learnedItems));
            updateMasteryBar();
            renderKnowledgeBase(); // Re-render to update icon state
        };

        function updateMasteryBar() {
            const pct = Math.round((learnedItems.length / sourceData.length) * 100);
            document.getElementById('mastery-bar').style.width = `${pct}%`;
            document.getElementById('mastery-text').innerText = `${pct}%`;
        }

        // Listeners
        document.getElementById('searchInput').addEventListener('input', renderKnowledgeBase);
        document.getElementById('categoryFilter').addEventListener('change', renderKnowledgeBase);

        // Start
        init();

    </script>
    
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. All visual elements built with Chart.js Canvas and FontAwesome icons. -->
</body>
</html>
